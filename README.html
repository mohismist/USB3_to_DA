<h1>通信协议</h1>

<p>为了方便数据的转存，采用单独的数据包标识下一个数据包的属性。</p>

<h2>标识方法</h2>

<p>在32个字节的前31个字节中全部填上32'haaaaaaaa,最后一个字节填上{8'hff,16'h标识符,8'haa}的数据，表示下一个数据的性质，其中标示位对应下表:</p>

<table>
<thead>
<tr>
  <th align="center">标识位</th>
  <th align="center">16'h0000</th>
  <th align="center">16'h000a</th>
  <th align="center">16'h00aa</th>
  <th align="center">16'h0aaa</th>
  <th align="center">16'haaaa</th>
</tr>
</thead>
<tbody>
<tr>
  <td align="center">下一个包内容</td>
  <td align="center">C/A码</td>
  <td align="center">导航电文</td>
  <td align="center">频率字相位字以及C/A延迟</td>
  <td align="center">待用</td>
  <td align="center">待用</td>
</tr>
</tbody>
</table>

<h4>1."C/A码"</h4>

<ul>
<li>一个包同时传输八个信道的数据，每个信道长度1024bits，即32个UINT32数。</li>
<li>包的第i=int(n/32)个UINT32数为第i个信道的数据。</li>
<li>由于C/A码长度为1023，每一路的第1个bit位为有效位，1'b1表示有效。</li>
</ul>

<h4>2."导航电文"</h4>

<ul>
<li>一个包同时传输八个信道的数据，每个信道长度320bits，即10个UINT32数。</li>
<li>包的第i=int(n/10)个UINT32数为第i个信道的数据。</li>
<li>数据填充如下
<ol>
<li>电文数据前20bits用于表示信道编号以及电文有效性</li>
<li>电文信道编号分配为：16'h00xx，x表示数据有效性，16'h00aa为有效，对于无效的数据，导航电文无须更新。</li>
<li>接下来的4bits代表对应的信道编号，有效值为16进制的0~7</li>
<li>后300bits为导航电文一个完整的子帧</li>
<li>一个包后面剩余的5632bits(176个UINT32)用0补齐。</li>
</ol></li>
</ul>

<h4>3."频率字相位字以及C/A延迟"</h4>

<ul>
<li>每个标示位之后传递8个完整的包，按照顺序依次对应8个信道的控制参数。
频率字、相位字以及C/A码延迟数每次传输64组数据(每64ms传输一次)</li>
<li>按照信道依次打包，因此每个信道正好对应1024字节的数据。每个信道数据依次如下
<ol>
<li>64组UINT32载波频率字</li>
<li>64组UINT32伪码频率字</li>
<li>64组UINT32相位字</li>
<li>64组UINT32延迟数 </li>
</ol></li>
</ul>

<p>所有数据都放在总线的低位，空缺的高位用0补齐。</p>
